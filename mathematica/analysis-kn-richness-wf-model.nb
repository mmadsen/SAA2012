(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     10572,        264]
NotebookOptionsPosition[      9871,        235]
NotebookOutlinePosition[     10224,        251]
CellTagsIndexPosition[     10181,        248]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Analysis of K_n Samples From Time-Averaged Wright-Fisher Model \
\>", "Title",
 CellChangeTimes->{{3.539369672219623*^9, 3.539369695554105*^9}}],

Cell["Mark E. Madsen    Feb 2012", "Subtitle",
 CellChangeTimes->{{3.539369706275262*^9, 3.539369714545929*^9}}],

Cell["\<\
This notebook records the analysis of 779,559 values of K_n, the number of \
discrete traits found in samples of size n from a Wright-Fisher neutral \
model, across a wide variety of \[Theta] values and amounts of cumulative \
time averaging.  Samples were always 30 individuals, sampled randomly from \
the population, or from the set of generations being averaged in a \
time-averaging window.  
The simulated population was uniformly chosen to be 2000 individuals, with \
100 initial traits.  Data were not gathered for the first 750 generations in \
any simulation run, to allow the effects of initial transient behavior to \
decay and for the population to reach quasi-stationary equilibrium.  \
Simulation runs were conducted both at 5000 steps, and a more limited number \
at 50000 steps, to examine a wide range of time-averaging durations.  \
\>", "Text",
 CellChangeTimes->{{3.539369729386003*^9, 3.539369954139288*^9}}],

Cell[TextData[{
 "The distribution of K_n is given by Ewens (2004), and is analyzed in the \
linked notebooks:  ",
 ButtonBox["Convolution_kn",
  BaseStyle->"Hyperlink",
  ButtonData->{
    FrontEnd`FileName[{$RootDirectory, "Users", "mark", "Dropbox", "Research",
       "Dissertation Project", "analysis", "saa2012"}, "convolution-k_n.nb", 
     CharacterEncoding -> "UTF-8"], None}],
 " and ",
 ButtonBox["Ewens Neutral Model",
  BaseStyle->"Hyperlink",
  ButtonData->{
    FrontEnd`FileName[{$RootDirectory, "Users", "mark", "Dropbox", "Research",
       "Dissertation Project", "analysis", "saa2012"}, 
     "ewens-neutral-model.nb", CharacterEncoding -> "UTF-8"], None}],
 ".  "
}], "Text",
 CellChangeTimes->{{3.539369984932559*^9, 3.539370072188733*^9}}],

Cell[CellGroupData[{

Cell["Data", "Section",
 CellChangeTimes->{{3.539370091010312*^9, 3.539370091488819*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\</Users/mark/Dropbox/Research/diss/analysis/saa2012\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.5393701014202538`*^9, 3.539370127321824*^9}}],

Cell[BoxData["\<\"/Users/mark/Dropbox/Research/Dissertation \
Project/analysis/saa2012\"\>"], "Output",
 CellChangeTimes->{3.539370160042738*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", "data", "]"}]], "Input",
 CellChangeTimes->{{3.539370163721446*^9, 3.539370166000949*^9}}],

Cell[BoxData[
 RowBox[{"data", " ", "=", " ", 
  RowBox[{"Import", "[", 
   RowBox[{"\"\<knsample-wf-mean.csv\>\"", ",", " ", "\"\<CSV\>\""}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.539370179823951*^9, 3.539370193873362*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", GridBox[{
     {"\"\<\>\"", "\"\<WindowSize\>\"", "\"\<Theta\>\"", "\"\<x\>\""},
     {"1", "1", "12.`", "7.70121220735446`"},
     {"2", "1250", "12.`", "14.2051282051282`"},
     {"3", "156", "12.`", "8.82222222222222`"},
     {"4", "19", "12.`", "7.77507716049383`"},
     {"5", "2", "12.`", "7.65858512020793`"},
     {"6", "2500", "12.`", "16.4736842105263`"},
     {"7", "312", "12.`", "10.1146496815287`"},
     {"8", "39", "12.`", "7.94690966719493`"},
     {"9", "4", "12.`", "7.69160168940871`"},
     {"10", "5000", "12.`", "20"},
     {"11", "625", "12.`", "11.8461538461538`"},
     {"12", "78", "12.`", "8.36925515055468`"},
     {"13", "9", "12.`", "7.66831140350877`"},
     {"14", "1", "16.`", "9.41444496334951`"},
     {"15", "1250", "16.`", "17.2820512820513`"},
     {"16", "156", "16.`", "11.0825396825397`"},
     {"17", "19", "16.`", "9.59876543209877`"},
     {"18", "2", "16.`", "9.35319200779727`"},
     {"19", "2500", "16.`", "19.1578947368421`"},
     {"20", "312", "16.`", "12.7070063694268`"},
     {"21", "39", "16.`", "9.8256735340729`"},
     {"22", "4", "16.`", "9.36980181936322`"},
     {"23", "5000", "16.`", "20.1111111111111`"},
     {"24", "625", "16.`", "15.2564102564103`"},
     {"25", "78", "16.`", "10.4532488114105`"},
     {"26", "9", "16.`", "9.48684210526316`"},
     {"27", "1", "2.`", "25.7831311697529`"},
     {"28", "125", "2.`", "24.9494949494949`"},
     {"29", "1250", "2.`", "18.974358974359`"},
     {"30", "15", "2.`", "25.4829210836278`"},
     {"31", "156", "2.`", "24.984126984127`"},
     {"32", "19", "2.`", "25.6875`"},
     {"33", "2", "2.`", "25.8896198830409`"},
     {"34", "250", "2.`", "24.9375`"},
     {"35", "2500", "2.`", "9.05263157894737`"},
     {"36", "3", "2.`", "25.3893596986817`"},
     {"37", "31", "2.`", "25.1313868613139`"},
     {"38", "312", "2.`", "24.8535031847134`"},
     {"39", "39", "2.`", "25.8581616481775`"},
     {"40", "4", "2.`", "25.7905295646524`"},
     {"41", "500", "2.`", "21.2916666666667`"},
     {"42", "5000", "2.`", "8"},
     {"43", "62", "2.`", "24.5882352941176`"},
     {"44", "625", "2.`", "21"},
     {"45", "7", "2.`", "25.2546754675468`"},
     {"46", "78", "2.`", "25.5641838351823`"},
     {"47", "9", "2.`", "25.9892178362573`"},
     {"48", "1", "20.`", "11.1229756758501`"},
     {"49", "125", "20.`", "13.1818181818182`"},
     {"50", "1250", "20.`", "19.0512820512821`"},
     {"51", "15", "20.`", "11.5724381625442`"},
     {"52", "156", "20.`", "13.1904761904762`"},
     {"53", "19", "20.`", "11.2391975308642`"},
     {"54", "2", "20.`", "10.9595922677063`"},
     {"55", "250", "20.`", "14.9166666666667`"},
     {"56", "2500", "20.`", "20.6842105263158`"},
     {"57", "3", "20.`", "11.319209039548`"},
     {"58", "31", "20.`", "11.8296836982968`"},
     {"59", "312", "20.`", "14.5987261146497`"},
     {"60", "39", "20.`", "11.6180665610143`"},
     {"61", "4", "20.`", "11.0455653021442`"},
     {"62", "500", "20.`", "17.5416666666667`"},
     {"63", "5000", "20.`", "21.6666666666667`"},
     {"64", "62", "20.`", "12.4166666666667`"},
     {"65", "625", "20.`", "16.5769230769231`"},
     {"66", "7", "20.`", "11.45599559956`"},
     {"67", "78", "20.`", "12.1188589540412`"},
     {"68", "9", "20.`", "11.0573830409357`"},
     {"69", "1", "4.`", "18.1126846893348`"},
     {"70", "125", "4.`", "13.7171717171717`"},
     {"71", "1250", "4.`", "6.25641025641026`"},
     {"72", "15", "4.`", "15.0471142520612`"},
     {"73", "156", "4.`", "15.5301587301587`"},
     {"74", "19", "4.`", "18.6114969135802`"},
     {"75", "2", "4.`", "18.6908300844704`"},
     {"76", "250", "4.`", "10.5`"},
     {"77", "2500", "4.`", "7.26315789473684`"},
     {"78", "3", "4.`", "16.2893126177024`"},
     {"79", "31", "4.`", "15.8272506082725`"},
     {"80", "312", "4.`", "15.4203821656051`"},
     {"81", "39", "4.`", "18.3058637083994`"},
     {"82", "4", "4.`", "18.5916991552956`"},
     {"83", "500", "4.`", "8.75`"},
     {"84", "5000", "4.`", "10.3333333333333`"},
     {"85", "62", "4.`", "14.2352941176471`"},
     {"86", "625", "4.`", "11.1282051282051`"},
     {"87", "7", "4.`", "16.464796479648`"},
     {"88", "78", "4.`", "16.7781299524564`"},
     {"89", "9", "4.`", "18.468567251462`"},
     {"90", "1", "40.`", "15.6126846893348`"},
     {"91", "125", "40.`", "17.7575757575758`"},
     {"92", "1250", "40.`", "22.3076923076923`"},
     {"93", "15", "40.`", "15.7514723203769`"},
     {"94", "156", "40.`", "18.0825396825397`"},
     {"95", "19", "40.`", "15.9108796296296`"},
     {"96", "2", "40.`", "15.5248538011696`"},
     {"97", "250", "40.`", "18.6041666666667`"},
     {"98", "2500", "40.`", "22.9473684210526`"},
     {"99", "3", "40.`", "15.4828154425612`"},
     {"100", "31", "40.`", "16.1678832116788`"},
     {"101", "312", "40.`", "19.0828025477707`"},
     {"102", "39", "40.`", "16.2052297939778`"},
     {"103", "4", "40.`", "15.5715562053281`"},
     {"104", "500", "40.`", "20.4166666666667`"},
     {"105", "5000", "40.`", "23.2222222222222`"},
     {"106", "62", "40.`", "16.671568627451`"},
     {"107", "625", "40.`", "20.6794871794872`"},
     {"108", "7", "40.`", "15.6540154015402`"},
     {"109", "78", "40.`", "16.9413629160063`"},
     {"110", "9", "40.`", "15.6277412280702`"},
     {"111", "1", "8.`", "7.47033679592232`"},
     {"112", "125", "8.`", "7.27272727272727`"},
     {"113", "1250", "8.`", "9.87179487179487`"},
     {"114", "15", "8.`", "7.02591283863369`"},
     {"115", "156", "8.`", "6.87936507936508`"},
     {"116", "19", "8.`", "7.14467592592593`"},
     {"117", "2", "8.`", "7.53411306042885`"},
     {"118", "250", "8.`", "7.47916666666667`"},
     {"119", "2500", "8.`", "14.3157894736842`"},
     {"120", "3", "8.`", "7.30108286252354`"},
     {"121", "31", "8.`", "6.75669099756691`"},
     {"122", "312", "8.`", "7.57324840764331`"},
     {"123", "39", "8.`", "7.19809825673534`"},
     {"124", "4", "8.`", "7.50162443144899`"},
     {"125", "500", "8.`", "7.33333333333333`"},
     {"126", "5000", "8.`", "16.2222222222222`"},
     {"127", "62", "8.`", "7.30882352941176`"},
     {"128", "625", "8.`", "8.41025641025641`"},
     {"129", "7", "8.`", "7.12816281628163`"},
     {"130", "78", "8.`", "6.74801901743265`"},
     {"131", "9", "8.`", "7.65588450292398`"}
    }], ")"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.539370546806642*^9, 3.539370546827738*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{740, 860},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 5, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 154, 3, 123, "Title"],
Cell[736, 27, 112, 1, 46, "Subtitle"],
Cell[851, 30, 940, 14, 116, "Text"],
Cell[1794, 46, 762, 18, 41, "Text"],
Cell[CellGroupData[{
Cell[2581, 68, 89, 1, 67, "Section"],
Cell[CellGroupData[{
Cell[2695, 73, 196, 4, 27, "Input"],
Cell[2894, 79, 145, 2, 27, "Output"]
}, Open  ]],
Cell[3054, 84, 127, 2, 27, "Input"],
Cell[3184, 88, 231, 5, 27, "Input"],
Cell[3418, 95, 6425, 136, 2152, InheritFromParent]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
